<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Proxmox Cluster with QDevice & Data Center Manager</title>
  <link rel="icon" type="image/x-icon" href="image/favicon.ico">
  <link rel="stylesheet" href="Blog_Post.css">

  <!-- Social Embed -->
  <meta property="og:title" content="Holden Weber – IT Blog">
  <meta property="og:description" content="Networking, Linux, automation, and home lab writeups.">
  <meta property="og:image" content="https://graphicalnetworks.com/wp-content/uploads/2018/06/logical-network-diagram-example.png">
  <meta property="og:url" content="https://holdenweber.com/">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://graphicalnetworks.com/wp-content/uploads/2018/06/logical-network-diagram-example.png">
</head>
<body>
  <div id="mySidenav" class="sidenav">
    <a href="index.html">Home</a>
    <a href="Blog.html">Blog</a>
    <a href="about.html">About Me</a>
    <a href="Holden_Weber_Resume.html">Resume</a>
  </div>

  <!-- Hamburger Menu -->
  <span onclick="openNav()">
    <div class="hamburger" id="hamburger">
      <div class="line"></div>
      <div class="line"></div>
      <div class="line"></div>
    </div>
  </span>

  <header>
    <h1>Proxmox Cluster with QDevice & Data Center Manager</h1>
  </header>

  <main>
    <section>
      <h2>Introduction</h2>
      <p>I am setting up another Proxmox server and making a cluster with my current one. I will then install and setup Proxmox Data Center to have a dashboard to view my Proxmox environment.</p>
    </section>

    <section>
      <h2>Setting up the Cluster</h2>
      
      <h3>Main Node Configuration</h3>
      <p>On the main node, create the cluster with the command:</p>
      <pre>pvecm create homelab</pre>
      <img src="/images/proxmox_cluster_qdevice_datacenter_manager/image1.png" alt="Cluster creation output" width="100%">
      <p><em>Fig 1: Creating the Proxmox Cluster</em></p>

      <p>Check cluster status:</p>
      <pre>pvecm status</pre>
      <img src="/images/proxmox_cluster_qdevice_datacenter_manager/image2.png" alt="Primary node status" width="100%">
      <p><em>Fig 2: Primary node status</em></p>
    </section>

    <section>
      <h3>Node 2 Configuration</h3>
      <p>Join node 2 to the cluster (replace IP with primary node's IP):</p>
      <pre>pvecm add 172.16.1.24</pre>
      <img src="/images/proxmox_cluster_qdevice_datacenter_manager/image3.png" alt="Node 2 join output" width="100%">
      <p><em>Fig 3: Node 2 added to cluster</em></p>

      <p>Verify nodes:</p>
      <pre>pvecm nodes</pre>
      <img src="/images/proxmox_cluster_qdevice_datacenter_manager/image4.png" alt="Cluster nodes list" width="100%">
      <p><em>Fig 4: Cluster nodes listing</em></p>
    </section>

    <section>
      <h2>QDevice Setup</h2>
      <p>With only 2 nodes, you need a QDevice to maintain quorum if one node fails. This can be a small VM, Raspberry Pi, or another system.</p>
      <ul>
        <li>Cores: 1</li>
        <li>RAM: 1 GB</li>
        <li>Storage: 6 GB</li>
        <li>OS: Debian 12</li>
      </ul>

      <h3>Configuration Steps</h3>
      <p>Set a static IP for the QDevice:</p>
      <pre>nano /etc/network/interfaces</pre>
      <img src="/images/proxmox_cluster_qdevice_datacenter_manager/image5.png" alt="Static IP config" width="100%">
      <p><em>Fig 5: Configuring static IP</em></p>

      <p>Install corosync on QDevice:</p>
      <pre>apt install corosync-qnetd -y</pre>

      <p>Adjust SSH settings for root login and password authentication:</p>
      <pre>
PermitRootLogin yes
PasswordAuthentication yes
      </pre>

      <p>Install corosync qdevice on both Proxmox nodes:</p>
      <pre>apt install corosync-qdevice -y</pre>
      <p>Setup QDevice on one node:</p>
      <pre>pvecm qdevice setup 172.16.1.50</pre>

      <p>Verify quorum:</p>
      <pre>pvecm status</pre>
      <img src="/images/proxmox_cluster_qdevice_datacenter_manager/image2.png" alt="Cluster status with QDevice" width="100%">
      <p><em>Fig 6: Cluster status showing quorum</em></p>
    </section>

    <section>
      <h2>Proxmox Web UI Overview</h2>
      <p>View your nodes in the web UI:</p>
      <img src="/images/proxmox_cluster_qdevice_datacenter_manager/image5.png" alt="Proxmox nodes in web UI" width="100%">
      <p><em>Fig 7: Nodes visible in Proxmox web interface</em></p>
    </section>

    <section>
      <h2>Data Center Manager Setup</h2>
      <p>Download Proxmox Data Center Manager: <a href="https://www.proxmox.com/en/downloads/proxmox-datacenter-manager">Download</a></p>

      <h3>Installation</h3>
      <ul>
        <li>Cores: 2</li>
        <li>RAM: 4 GB</li>
        <li>Disk: 40 GB</li>
        <li>OS: Proxmox DCM</li>
      </ul>
      <p>Access DCM at: <a href="http://your-ip:8443">http://your-ip:8443</a></p>

      <h3>Linking with Cluster</h3>
      <p>In DCM: Remotes → Add → Proxmox VE. Enter server IP and port.</p>
      <img src="/images/proxmox_cluster_qdevice_datacenter_manager/image13.png" alt="Add Proxmox remote" width="100%">
      <p><em>Fig 8: Adding Proxmox remote</em></p>

      <h3>Creating and Using API Token</h3>
      <p>Generate token on primary node (Datacenter → Permissions → API Tokens → Add):</p>
      <img src="/images/proxmox_cluster_qdevice_datacenter_manager/image14.png" alt="Create API token" width="100%">
      <p><em>Fig 9: Creating API token</em></p>

      <p>Copy Token ID and Secret into DCM remote setup:</p>
      <img src="/images/proxmox_cluster_qdevice_datacenter_manager/image9.png" alt="Token ID and Secret" width="100%">
      <p><em>Fig 10: Token credentials</em></p>

      <img src="/images/proxmox_cluster_qdevice_datacenter_manager/image10.png" alt="DCM remote setup" width="100%">
      <p><em>Fig 11: Configuring remote in DCM</em></p>

      <img src="/images/proxmox_cluster_qdevice_datacenter_manager/image7.png" alt="DCM summary" width="100%">
      <p><em>Fig 12: Summary of remote setup</em></p>
    </section>

    <section>
      <h2>Accessing Dashboard</h2>
      <p>View cluster information in DCM dashboard:</p>
      <img src="/images/proxmox_cluster_qdevice_datacenter_manager/image3.png" alt="DCM dashboard" width="100%">
      <p><em>Fig 13: Data Center Manager dashboard</em></p>
    </section>
  </main>

  <script src="myscripts.js"></script>
  <footer>
    <p>Author: Holden Weber</p>
  </footer>
</body>
</html>
